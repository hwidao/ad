<!-- ê²Œì‹œíŒ (localStorage ê¸°ë°˜) -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê²Œì‹œíŒ (ì‚­ì œ/ìˆ˜ì • ê°€ëŠ¥)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    textarea {
      width: 100%;
      height: 100px;
      font-size: 16px;
    }

    input[type="file"] {
      margin-top: 10px;
    }

    button {
      margin-top: 10px;
      padding: 8px 16px;
      cursor: pointer;
    }

    .post {
      border: 1px solid #ccc;
      margin-top: 20px;
      padding: 10px;
      position: relative;
    }

    .post img {
      max-width: 200px;
      display: block;
      margin-top: 10px;
    }

    .post-actions {
      margin-top: 10px;
    }

    .post-actions button {
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h2>ğŸ“Œ ê²Œì‹œíŒ</h2>

  <textarea id="message" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea><br>
  <input type="file" id="imageInput" accept="image/*"><br>
  <button onclick="submitPost()">ë“±ë¡</button>

  <hr>

  <div id="postsContainer"></div>

  <script>
    let editIndex = null;

    function submitPost() {
      const message = document.getElementById('message').value.trim();
      const imageInput = document.getElementById('imageInput');
      const file = imageInput.files[0];

      if (!message && !file) {
        alert("ë‚´ìš© ë˜ëŠ” ì´ë¯¸ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        return;
      }

      const reader = new FileReader();

      reader.onload = function () {
        const posts = JSON.parse(localStorage.getItem('posts') || '[]');

        const newPost = {
          message,
          image: file ? reader.result : null,
          date: new Date().toLocaleString()
        };

        if (editIndex !== null) {
          posts[editIndex] = newPost;
          editIndex = null;
        } else {
          posts.unshift(newPost);
        }

        localStorage.setItem('posts', JSON.stringify(posts));
        renderPosts();

        document.getElementById('message').value = '';
        document.getElementById('imageInput').value = '';
      };

      if (file) {
        reader.readAsDataURL(file);
      } else {
        // ì´ë¯¸ì§€ ì—†ì´ë„ ë™ì‘
        reader.onload();
      }
    }

    function renderPosts() {
      const posts = JSON.parse(localStorage.getItem('posts') || '[]');
      const container = document.getElementById('postsContainer');
      container.innerHTML = '';

      posts.forEach((post, index) => {
        const div = document.createElement('div');
        div.className = 'post';

        div.innerHTML = `
          <p><strong>ì‘ì„±ì¼:</strong> ${post.date}</p>
          <p>${post.message}</p>
          ${post.image ? `<img src="${post.image}" alt="ì²¨ë¶€ ì´ë¯¸ì§€">` : ''}
          <div class="post-actions">
            <button onclick="editPost(${index})">ìˆ˜ì •</button>
            <button onclick="deletePost(${index})">ì‚­ì œ</button>
          </div>
        `;

        container.appendChild(div);
      });
    }

    function deletePost(index) {
      if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        const posts = JSON.parse(localStorage.getItem('posts') || '[]');
        posts.splice(index, 1);
        localStorage.setItem('posts', JSON.stringify(posts));
        renderPosts();
      }
    }

    function editPost(index) {
      const posts = JSON.parse(localStorage.getItem('posts') || '[]');
      const post = posts[index];

      document.getElementById('message').value = post.message;
      document.getElementById('imageInput').value = '';
      editIndex = index;
    }

    renderPosts();
  </script>

</body>
</html>
