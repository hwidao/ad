<!-- 게시판 (localStorage 기반) -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>게시판 (삭제/수정 가능)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    textarea {
      width: 100%;
      height: 100px;
      font-size: 16px;
    }

    input[type="file"] {
      margin-top: 10px;
    }

    button {
      margin-top: 10px;
      padding: 8px 16px;
      cursor: pointer;
    }

    .post {
      border: 1px solid #ccc;
      margin-top: 20px;
      padding: 10px;
      position: relative;
    }

    .post img {
      max-width: 200px;
      display: block;
      margin-top: 10px;
    }

    .post-actions {
      margin-top: 10px;
    }

    .post-actions button {
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h2>📌 게시판</h2>

  <textarea id="message" placeholder="내용을 입력하세요"></textarea><br>
  <input type="file" id="imageInput" accept="image/*"><br>
  <button onclick="submitPost()">등록</button>

  <hr>

  <div id="postsContainer"></div>

  <script>
    let editIndex = null;

    function submitPost() {
      const message = document.getElementById('message').value.trim();
      const imageInput = document.getElementById('imageInput');
      const file = imageInput.files[0];

      if (!message && !file) {
        alert("내용 또는 이미지를 입력하세요.");
        return;
      }

      const reader = new FileReader();

      reader.onload = function () {
        const posts = JSON.parse(localStorage.getItem('posts') || '[]');

        const newPost = {
          message,
          image: file ? reader.result : null,
          date: new Date().toLocaleString()
        };

        if (editIndex !== null) {
          posts[editIndex] = newPost;
          editIndex = null;
        } else {
          posts.unshift(newPost);
        }

        localStorage.setItem('posts', JSON.stringify(posts));
        renderPosts();

        document.getElementById('message').value = '';
        document.getElementById('imageInput').value = '';
      };

      if (file) {
        reader.readAsDataURL(file);
      } else {
        // 이미지 없이도 동작
        reader.onload();
      }
    }

    function renderPosts() {
      const posts = JSON.parse(localStorage.getItem('posts') || '[]');
      const container = document.getElementById('postsContainer');
      container.innerHTML = '';

      posts.forEach((post, index) => {
        const div = document.createElement('div');
        div.className = 'post';

        div.innerHTML = `
          <p><strong>작성일:</strong> ${post.date}</p>
          <p>${post.message}</p>
          ${post.image ? `<img src="${post.image}" alt="첨부 이미지">` : ''}
          <div class="post-actions">
            <button onclick="editPost(${index})">수정</button>
            <button onclick="deletePost(${index})">삭제</button>
          </div>
        `;

        container.appendChild(div);
      });
    }

    function deletePost(index) {
      if (confirm("정말 삭제하시겠습니까?")) {
        const posts = JSON.parse(localStorage.getItem('posts') || '[]');
        posts.splice(index, 1);
        localStorage.setItem('posts', JSON.stringify(posts));
        renderPosts();
      }
    }

    function editPost(index) {
      const posts = JSON.parse(localStorage.getItem('posts') || '[]');
      const post = posts[index];

      document.getElementById('message').value = post.message;
      document.getElementById('imageInput').value = '';
      editIndex = index;
    }

    renderPosts();
  </script>

</body>
</html>
